new class{constructor(){this.init()}init(){chrome.runtime.onInstalled.addListener(e=>{"install"===e.reason&&console.log("Behance & Dribbble Downloader installed")}),chrome.runtime.onMessage.addListener((e,t,o)=>(this.handleMessage(e,t,o),!0)),chrome.tabs.onUpdated.addListener((e,t,o)=>{"complete"===t.status&&this.updateBadge(o)}),chrome.tabs.onActivated.addListener(e=>{chrome.tabs.get(e.tabId,e=>{this.updateBadge(e)})})}async handleMessage(e,t,o){try{switch(e.action){case"checkPage":const r=e.url||(t.tab?t.tab.url:null);o({supported:this.isSupportedPage(r)});break;case"downloadProgress":this.updateDownloadProgress(e.progress);break;default:o({error:"Unknown action"})}}catch(e){console.error("Background script error:",e),o({error:e.message})}}isSupportedPage(e){if(!e)return!1;if(e.includes("behance.net/gallery/"))return!0;if(e.includes("dribbble.com/")||e.includes("www.dribbble.com/")){const t=["/about","/contact","/terms","/privacy","/login","/signup","/session/new","/account","/settings","/explore","/following","/likes","/buckets","/tags","/search","/jobs","/pro","/hiring","/freelance-jobs","/full-time-jobs","/go-pro"];for(const o of t)if(e.includes(o))return!1;return!0}return!1}updateBadge(e){e&&e.url&&(this.isSupportedPage(e.url)?(chrome.action.setBadgeText({text:"âœ“",tabId:e.id}),chrome.action.setBadgeBackgroundColor({color:"#28a745",tabId:e.id}),chrome.action.setTitle({title:"Download media from this portfolio",tabId:e.id})):(chrome.action.setBadgeText({text:"",tabId:e.id}),chrome.action.setTitle({title:"Navigate to a Behance gallery or Dribbble shot to download media",tabId:e.id})))}updateDownloadProgress(e){if(e&&e.current&&e.total){const t=Math.round(e.current/e.total*100);chrome.action.setBadgeText({text:`${t}%`}),chrome.action.setBadgeBackgroundColor({color:"#007bff"})}}};